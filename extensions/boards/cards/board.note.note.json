{
  "defaults": {
    "editRulesInLowCode": false,
    "editRulesInNaturalLanguage": false,
    "width": 3,
    "height": 10,
    "name": "Note",
    "icon": "sticky-note",
    "description": "Editable note with Markdown support. Double-click to edit, click outside to save. Access note content via states.",
    "type": "value",
    "displayTitle": true,
    "displayIcon": false,
    "displayResponse": false,
    "color": "$color4",
    "bgColor": "var(--color3)",
    "noteContent": "# ðŸ“ My Note\n\nDouble-click here to start writing...\n\n## Markdown Support\n- **Bold**, *italic*, ~~strikethrough~~\n- Lists, tables, code blocks\n- [Links](https://vento.build)\n\n```js\nconsole.log(\"Hello from Vento!\")\n```",
    "rulesCode": "return data.noteContent || ''",
    "html": "//@card/react\n\nfunction Widget(card) {\n  const [isEditing, setIsEditing] = React.useState(false);\n  const [content, setContent] = React.useState(card.noteContent || '');\n  const textareaRef = React.useRef(null);\n  const containerRef = React.useRef(null);\n  const contentRef = React.useRef(card.noteContent || '');\n  \n  React.useEffect(() => {\n    if (!isEditing) {\n      setContent(card.noteContent || '');\n      contentRef.current = card.noteContent || '';\n    }\n  }, [card.noteContent, isEditing]);\n  \n  const saveNote = React.useCallback(() => {\n    const newContent = textareaRef.current ? textareaRef.current.value : contentRef.current;\n    const cardName = card.name;\n    \n    // Use onChangeCardData which is the proper method\n    if (window.onChangeCardData && window.onChangeCardData[cardName]) {\n      window.onChangeCardData[cardName]({ noteContent: newContent });\n    }\n    \n    setContent(newContent);\n    contentRef.current = newContent;\n    setIsEditing(false);\n  }, [card.name]);\n  \n  React.useEffect(() => {\n    if (!isEditing) return;\n    \n    const handleClickOutside = (e) => {\n      if (containerRef.current && !containerRef.current.contains(e.target)) {\n        saveNote();\n      }\n    };\n    \n    const timeoutId = setTimeout(() => {\n      document.addEventListener('mousedown', handleClickOutside, true);\n    }, 100);\n    \n    return () => {\n      clearTimeout(timeoutId);\n      document.removeEventListener('mousedown', handleClickOutside, true);\n    };\n  }, [isEditing, saveNote]);\n  \n  React.useEffect(() => {\n    if (isEditing && textareaRef.current) {\n      textareaRef.current.focus();\n      const len = textareaRef.current.value.length;\n      textareaRef.current.setSelectionRange(len, len);\n    }\n  }, [isEditing]);\n  \n  const handleDoubleClick = (e) => {\n    e.stopPropagation();\n    e.preventDefault();\n    if (!isEditing) {\n      setIsEditing(true);\n    }\n  };\n  \n  const handleKeyDown = (e) => {\n    e.stopPropagation();\n    if (e.key === 'Escape') {\n      setContent(card.noteContent || '');\n      setIsEditing(false);\n    }\n    if (e.key === 's' && (e.ctrlKey || e.metaKey)) {\n      e.preventDefault();\n      saveNote();\n    }\n  };\n  \n  const stopEvent = (e) => {\n    e.stopPropagation();\n  };\n  \n  return (\n    <Tinted>\n      <ProtoThemeProvider forcedTheme={window.TamaguiTheme}>\n        <div\n          ref={containerRef}\n          className=\"no-drag\"\n          onDoubleClick={handleDoubleClick}\n          onMouseDown={stopEvent}\n          onMouseMove={stopEvent}\n          onMouseUp={stopEvent}\n          onDragStart={(e) => e.preventDefault()}\n          style={{\n            display: 'flex',\n            flexDirection: 'column',\n            height: '100%',\n            width: '100%',\n            padding: '12px',\n            cursor: isEditing ? 'text' : 'pointer',\n            userSelect: isEditing ? 'text' : 'none',\n            WebkitUserSelect: isEditing ? 'text' : 'none',\n          }}\n        >\n          {isEditing ? (\n            <div style={{ display: 'flex', flexDirection: 'column', flex: 1, gap: '8px' }}>\n              <div style={{ \n                display: 'flex', \n                justifyContent: 'space-between', \n                alignItems: 'center',\n                fontSize: '11px',\n                color: 'var(--color8)',\n              }}>\n                <span>Editing (Esc cancel, Ctrl+S save)</span>\n                <span \n                  style={{ cursor: 'pointer', color: 'var(--green9)', fontWeight: 'bold' }} \n                  onClick={(e) => { e.stopPropagation(); saveNote(); }}\n                >\n                  âœ“ Save & Close\n                </span>\n              </div>\n              <textarea\n                ref={textareaRef}\n                className=\"no-drag\"\n                defaultValue={content}\n                onChange={(e) => { contentRef.current = e.target.value; }}\n                onKeyDown={handleKeyDown}\n                onMouseDown={stopEvent}\n                onMouseMove={stopEvent}\n                onMouseUp={stopEvent}\n                onDragStart={(e) => e.preventDefault()}\n                style={{\n                  flex: 1,\n                  width: '100%',\n                  minHeight: '100px',\n                  padding: '12px',\n                  fontSize: '14px',\n                  fontFamily: 'ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, monospace',\n                  backgroundColor: 'transparent',\n                  color: 'var(--color11)',\n                  border: '2px solid var(--green8)',\n                  borderRadius: '8px',\n                  resize: 'none',\n                  outline: 'none',\n                  lineHeight: '1.6',\n                  userSelect: 'text',\n                  WebkitUserSelect: 'text'\n                }}\n                placeholder=\"Write your note in Markdown...\"\n              />\n            </div>\n          ) : (\n            <div \n              className=\"markdown-body no-drag\"\n              style={{\n                flex: 1,\n                overflow: 'auto',\n                padding: '4px',\n                color: \"var(--color)\",\n                backgroundColor: \"transparent\",\n              }}\n            >\n              {content ? (\n                <ReactMarkdown \n                  remarkPlugins={[remarkGfm]}\n                  components={{\n                    a: ({node, ...props}) => <a {...props} target=\"_blank\" rel=\"noopener noreferrer\" />\n                  }}\n                >\n                  {content}\n                </ReactMarkdown>\n              ) : (\n                <div style={{ \n                  display: 'flex', \n                  alignItems: 'center', \n                  justifyContent: 'center',\n                  height: '100%',\n                  opacity: 0.5,\n                  color: 'var(--color9)',\n                  fontSize: '14px'\n                }}>\n                  Double-click to add a note...\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n      </ProtoThemeProvider>\n    </Tinted>\n  );\n}\n",
    "editorOptions": {
      "hiddenTabs": ["params"]
    }
  },
  "name": "Note", 
  "id": "board.note.note",
  "group": "board",
  "tag": "note",
  "templateName": "Note (Markdown)"
}
